<!DOCTYPE html>
<meta charset="utf-8">
<title>Time Zone World Map</title>
<style>
path {
  fill: none;
  stroke: #111;
}
div.tooltip {
  color: #222; 
  background: #fff; 
  padding: .5em; 
  text-shadow: #f5f5f5 0 1px 0;
  border-radius: 2px; 
  box-shadow: 0px 0px 2px 0px #a6a6a6; 
  opacity: 0.9; 
  position: absolute;
}
</style>
</head>
<body>

<h1>D3 World Map of Time Zones</h1>
<p>Countries and Time Zones in D3.js and TopoJson</p>

<script src="http://d3js.org/d3.v3.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>

<script>
var width = 960,height = 500;

var projection = d3.geo.mercator();

var color = d3.scale.category20();

var path = d3.geo.path().projection(projection);

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height)
    .call(d3.behavior.zoom()
    .on("zoom", redraw))
    .append("g");

var tooltip = d3.select('body').append("div").attr("class", "tooltip hidden");

function redraw() {
  var s = d3.event.scale;
  var t = d3.event.translate;

  svg.style("stroke-width", 1 / s).attr("transform", "translate(" + t + ")scale(" + s + ")");
}

d3.json("timezones-topo2.json", function(error, world) {
console.log(world);
  var tzdata = topojson.feature(world, world.objects.timezones).features;

  var tz = svg.selectAll(".tz").data(tzdata);

  tz.enter().insert("path")
      .attr("class", "tz")
      .attr("d", path)
      .attr("title", function(d,i) { console.log(d);return d.properties.Name; })
      .style("fill", function(d, i) { return color(d.properties.Name.replace(/[A-Za-z ]/g,"")); });


  //tooltips
  tz.on("mousemove", function(d,i) {
      var mouse = d3.mouse(svg.node()).map( function(d) { return parseInt(d); } );
        tooltip
          .classed("hidden", false)
          .attr("style", "left:"+(mouse[0]+20)+"px;top:"+(mouse[1]+100)+"px")
          .html(d.properties.Name)
      })
      .on("mouseout",  function(d,i) {
        tooltip.classed("hidden", true)
      }); 

});
</script>
</body>
</html>